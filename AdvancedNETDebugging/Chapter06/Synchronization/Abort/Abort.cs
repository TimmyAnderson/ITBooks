using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
//-------------------------------------------------------------------------------------------------------
namespace Abort
{
//-------------------------------------------------------------------------------------------------------
	class Abort
	{
//-------------------------------------------------------------------------------------------------------
        private void ThreadProc()
        {
            try
            {
				// Do some work.
            }
            finally
            {
				// !!! Vo FINALLY BLOCKU NIE JE MOZNE VOLAT ThreadAbortException a preto DOJDE k DEADLOCK.
				// Urobim LOCK nad objektom ABORT.
                lock(this)
				{
				}
			}
        }
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		static void Main(string[] args)
		{
            Abort			A=new Abort();

			// Urobim LOCK nad objektom ABORT.
			lock(A)
			{
				Thread			NewThread=new Thread(A.ThreadProc);

				NewThread.Start();

				Thread.Sleep(500);

				Console.WriteLine("Aborting worker thread !");
				NewThread.Abort();
			}
		}
//-------------------------------------------------------------------------------------------------------
	}
//-------------------------------------------------------------------------------------------------------
}
//-------------------------------------------------------------------------------------------------------