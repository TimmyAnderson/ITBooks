using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
//-------------------------------------------------------------------------------------------------------
namespace Service
{
//-------------------------------------------------------------------------------------------------------
	// Trieda priradzuje Roles k danym UserNames.
	public class CRolesStore
	{
//-------------------------------------------------------------------------------------------------------
		private static CRolesStore								MAuthorizationStore;
//-------------------------------------------------------------------------------------------------------
		private Dictionary<string,string[]>						MUsersAndRoles;
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		static CRolesStore()
		{
			Dictionary<string,string[]>			AuthorizationRules=new Dictionary<string,string[]>();

			AuthorizationRules.Add("Timmy",new string[]{"Boys","Children"});
			AuthorizationRules.Add("Atreyu",new string[]{"Boys","Children"});
			AuthorizationRules.Add("Jenny",new string[]{"Girls","Children"});

			MAuthorizationStore=new CRolesStore(AuthorizationRules);
		}
//-------------------------------------------------------------------------------------------------------
		public CRolesStore(Dictionary<string,string[]> AuthorizationRules)
		{
			MUsersAndRoles=AuthorizationRules;
		}
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		public static CRolesStore								AuthorizationStore
		{
			get
			{
				return(MAuthorizationStore);
			}
		}
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		public bool IsInRole(string UserName, string Role)
		{
			if (MUsersAndRoles.ContainsKey(UserName)==false)
				return(false);

			bool				Ret=MUsersAndRoles[UserName].Contains(Role);

			return(Ret);
		}
//-------------------------------------------------------------------------------------------------------
	}
//-------------------------------------------------------------------------------------------------------
}
//-------------------------------------------------------------------------------------------------------