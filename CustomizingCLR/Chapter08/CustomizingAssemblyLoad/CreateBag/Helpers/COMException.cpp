//------------------------------------------------------------------------------------------------------
#pragma warning(disable:4995)
//------------------------------------------------------------------------------------------------------
#include "COMException.h"
#include "Helpers.h"
//------------------------------------------------------------------------------------------------------
using namespace std;
//------------------------------------------------------------------------------------------------------
CCOMException::CCOMException(wstring Message)
	: MMessage(Message), MResult(S_OK)
{
}
//------------------------------------------------------------------------------------------------------
CCOMException::CCOMException(wstring Message, HRESULT Result)
	: MMessage(Message), MResult(Result)
{
}
//------------------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------------------
wstring CCOMException::GetMessage(void)
{
	return(MMessage);
}
//------------------------------------------------------------------------------------------------------
HRESULT CCOMException::GetResult(void)
{
	return(MResult);
}
//------------------------------------------------------------------------------------------------------
wstring CCOMException::GetFormattedMessageText(void)
{
	wstring														FormattedMessageText=CHelpers::PrepareLogMessage(MMessage,MResult);

	return(FormattedMessageText);
}
//------------------------------------------------------------------------------------------------------