using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
//-------------------------------------------------------------------------------------------------------
namespace CodeGeneration
{
//-------------------------------------------------------------------------------------------------------
	public sealed class COperand_Constant : COperand
	{
//-------------------------------------------------------------------------------------------------------
		private static readonly int								PADDING_SIZE=4;
//-------------------------------------------------------------------------------------------------------
		private int												MConstant;
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		public COperand_Constant(int Constant)
		{
			MConstant=Constant;
		}
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		public int												Constant
		{
			get
			{
				return(MConstant);
			}
		}
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------
		public override string GetOperandText()
		{
			string												ConstantText;

			if (MConstant>=0)
			{
				ConstantText=string.Format("{0:X}",MConstant);
				ConstantText=ConstantText.PadLeft(PADDING_SIZE,'0');
			}
			else
			{
				ConstantText=string.Format("{0:X}",-MConstant);
				ConstantText=ConstantText.PadLeft(PADDING_SIZE,'0');
				ConstantText=string.Format("-{0}",ConstantText);
			}

			string												OperandText=string.Format("{0}h",ConstantText);

			return(OperandText);
		}
//-------------------------------------------------------------------------------------------------------
	}
//-------------------------------------------------------------------------------------------------------
}
//-------------------------------------------------------------------------------------------------------