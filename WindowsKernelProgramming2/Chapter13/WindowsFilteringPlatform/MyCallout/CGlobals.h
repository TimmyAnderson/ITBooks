//----------------------------------------------------------------------------------------------------------------------
#pragma once
//----------------------------------------------------------------------------------------------------------------------
#include <ntifs.h>
#include "Helpers\MyKernelHelpers.h"
#include "Helpers/CMemoryOperators.h"
#include "Helpers/CSpinLock.h"
#include "CVector.h"
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
class CGlobals final : public CMemoryOperators
{
//----------------------------------------------------------------------------------------------------------------------
	private:
		mutable CSpinLock										MProcessesLock;
		KTL::CVector<ULONG,EPoolType::NonPaged,MY_TAG>			MProcesses;

	public:
		NTSTATUS AddProcess(ULONG PID);
		NTSTATUS DeleteProcess(ULONG PID);
		NTSTATUS ClearProcesses(void);
		NTSTATUS IsProcessBlocked(ULONG PID) const;

	public:
		CGlobals(void);
		~CGlobals(void);
//----------------------------------------------------------------------------------------------------------------------
};
//----------------------------------------------------------------------------------------------------------------------