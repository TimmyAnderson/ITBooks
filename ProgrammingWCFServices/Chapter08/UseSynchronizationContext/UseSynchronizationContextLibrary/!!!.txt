//-------------------------------------------------------------------------------------------------------
1. Solution demonstruje pouzitie SYNCHRONIZATION CONTEXT vo WCF.
!!! 2. Nastavenie UseSynchronizationContext=true zabezpecuje to, ze pri OTVARANI ServiceHost si ServiceHost zapameta SynchronizationContext aky bol aktualne nastaveny (SynchronizationContext.Current) na THREADE, ktory volal ServiceHostOpen() a VSETKY volania metod SERVICE bude realizovat pomocou tohto SynchronizationContext objektu.
3. Tym, ze UseSynchronizationContext=true automaticky forwarduje vlania do UI threadu (presnejsie contextu, ktory bol Current pri Open() service) tak to nemusim robit rucne cez delegatov ale meotdy formulara mozem volat PRIAMO.
4. Kedze SynchronizationContext je vo WinForm aplikacii vytoreny az po volani Application.Run() a ta je blokacna tak musi service byt otvoreny v konstruktore FORMULARA a zatvarany ked je formular zatvoreny - napriklad OnFormClosed().
!!! 5. SynchronizationContext sa da pouzit iba vo WinForm programoch nie v konzolovych prgramoch, kde je SynchronizationContext.Current na null. Samozrejme, mozem si implementovat CUSTOM SYNCHRONIZATION CONTEXT a ten pouzivat i v konzolovych aplikaciach.
!!! 6. Pri UseSynchronizationContext=true budu tela service bezat v threade GUI.
!!! 7. Synchornizacia prebieha aj nad VIACERYMI INSTANCIAMI SERVICE. Je to logicke, lebo VSETKY VOLANIA SU SMEROVANE DO JEDINEHO GUI THREADU.
!!!!! 8. Nastavenie UseSynchronizationContext=true ma zmysel ozaj iba pri praci s GUI, pretoze iba GUI thready maju SynchronizationContext. Ostatne, naprikla main thread konzolovej aplikacie ho nema takze by to nefungovalo. To je zas pochpitelne, lebo ak chcem forwardovat beh do ineho thradu musi to ist cez nejaky Message machanizmus. V GUI sa daju pouzit Windows Messages (WM_) zatial co pri konzole nic take nie je (dalo by sa oblbnut to skrytym oknom ako v COM). Takze jedine v GUI to ma vyznam, ak ma service menit controls GUI. Potom este aj vo WWF, kedze aj ten ma vlastnu implamentaciu SynchronizationContext - tipujem, ze tiez na nejakych Messages, kedze WWF je asi cele stavane na Messages.
!!! 9. POZOR. Ked na formulari dam EXIT sa sa zavrie formular a ZATVARA SA AJ SERVICE. Preto najprv treba zavriet klienta, inak to pri volani Close() na service zatuhne na minutu.
//-------------------------------------------------------------------------------------------------------