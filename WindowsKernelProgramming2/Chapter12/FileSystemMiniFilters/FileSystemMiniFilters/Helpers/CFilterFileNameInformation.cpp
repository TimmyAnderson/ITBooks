//----------------------------------------------------------------------------------------------------------------------
#include "CFilterFileNameInformation.h"
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
CFilterFileNameInformation::CFilterFileNameInformation(NTSTATUS& Status, PFLT_CALLBACK_DATA Data, EFileNameOptions Options=EFileNameOptions::E_QUERY_DEFAULT | EFileNameOptions::E_NORMALIZED)
	: MInfo(nullptr)
{
	Status=FltGetFileNameInformation(Data,static_cast<FLT_FILE_NAME_OPTIONS>(Options),&MInfo);

	if (NT_SUCCESS(Status)==false)
	{
		MInfo=nullptr;
	}
}
//----------------------------------------------------------------------------------------------------------------------
CFilterFileNameInformation::~CFilterFileNameInformation(void)
{
	if (MInfo!=nullptr)
	{
		FltReleaseFileNameInformation(MInfo);
	}
}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
CFilterFileNameInformation::operator bool(void) const
{
	if (MInfo!=nullptr)
	{
		return(true);
	}
	else
	{
		return(false);
	}
}
//----------------------------------------------------------------------------------------------------------------------
CFilterFileNameInformation::operator PFLT_FILE_NAME_INFORMATION(void) const
{
	return(MInfo);
}
//----------------------------------------------------------------------------------------------------------------------
PFLT_FILE_NAME_INFORMATION CFilterFileNameInformation::operator->(void)
{
	return(MInfo);
}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
NTSTATUS CFilterFileNameInformation::Parse(void)
{
	NTSTATUS													Status;

	Status=FltParseFileNameInformation(MInfo);

	return(Status);
}
//----------------------------------------------------------------------------------------------------------------------