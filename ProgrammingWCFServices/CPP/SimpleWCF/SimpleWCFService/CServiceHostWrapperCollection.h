#pragma once
//-------------------------------------------------------------------------------------------------------
#include <msclr/lock.h>
#include "IServiceHostWrapper.h"
//-------------------------------------------------------------------------------------------------------
using namespace System::Collections::Generic;
using namespace msclr;
//-------------------------------------------------------------------------------------------------------
namespace SimpleWCFService
{
//-------------------------------------------------------------------------------------------------------
	ref class CServiceHostWrapperCollection
	{
//-------------------------------------------------------------------------------------------------------
		private:
			Object^							MSyn;
			List<IServiceHostWrapper^>^		MList;
//-------------------------------------------------------------------------------------------------------
		public:
			void StartServices(void);
			void StopServices(void);
			void AddServiceHostWrapper(IServiceHostWrapper^ ServiceHostWrapper);
			bool RemoveServiceHostWrapper(int Index);
//-------------------------------------------------------------------------------------------------------
		public:
			CServiceHostWrapperCollection(void);
			virtual ~CServiceHostWrapperCollection(void);
//-------------------------------------------------------------------------------------------------------
	};
//-------------------------------------------------------------------------------------------------------
}
//-------------------------------------------------------------------------------------------------------