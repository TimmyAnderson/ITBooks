//----------------------------------------------------------------------------------------------------------------------
#include "KernelHeaders.h"
#include "SFilterFileNameInformation.h"
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
namespace KTL
{
//----------------------------------------------------------------------------------------------------------------------
	SFilterFileNameInformation::SFilterFileNameInformation(PFLT_CALLBACK_DATA Data, EFileNameOptions Options)
	{
		auto													Status=FltGetFileNameInformation(Data,(FLT_FILE_NAME_OPTIONS) Options,&MInfo);

		if (NT_SUCCESS(Status)==false)
		{
			MInfo=nullptr;
		}
	}
//----------------------------------------------------------------------------------------------------------------------
	SFilterFileNameInformation::~SFilterFileNameInformation(void)
	{
		if (MInfo!=nullptr)
		{
			FltReleaseFileNameInformation(MInfo);
			MInfo=nullptr;
		}
	}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
	PFLT_FILE_NAME_INFORMATION SFilterFileNameInformation::operator->(void)
	{
		return(MInfo);
	}
//----------------------------------------------------------------------------------------------------------------------
	SFilterFileNameInformation::operator bool(void) const
	{
		bool													Result=(MInfo!=nullptr);

		return(Result);
	}
//----------------------------------------------------------------------------------------------------------------------
	SFilterFileNameInformation::operator PFLT_FILE_NAME_INFORMATION(void) const
	{
		PFLT_FILE_NAME_INFORMATION								Result=Get();

		return(Result);
	}
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
	PFLT_FILE_NAME_INFORMATION SFilterFileNameInformation::Get(void) const
	{
		return(MInfo);
	}
//----------------------------------------------------------------------------------------------------------------------
	NTSTATUS SFilterFileNameInformation::Parse(void)
	{
		NTSTATUS												Result=FltParseFileNameInformation(MInfo);

		return(Result);
	}
//----------------------------------------------------------------------------------------------------------------------
}
//----------------------------------------------------------------------------------------------------------------------