#pragma once
//----------------------------------------------------------------------------------------------------------------------
#include <ntddk.h>
#include "Helpers/CFastMutexGlobal.h"
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------
class CGlobals final
{
//----------------------------------------------------------------------------------------------------------------------
	public:
		CFastMutexGlobal										MLock;
		LARGE_INTEGER											MRegistryCookie;
		RTL_GENERIC_TABLE										MProcessTable;

	private:
		static RTL_GENERIC_COMPARE_RESULTS CompareProcesses(PRTL_GENERIC_TABLE, PVOID First, PVOID Second);
		static PVOID AllocateProcess(PRTL_GENERIC_TABLE, CLONG Bytes);
		static void FreeProcess(PRTL_GENERIC_TABLE, PVOID Buffer);

	public:
		void Init(void);
//----------------------------------------------------------------------------------------------------------------------
};
//----------------------------------------------------------------------------------------------------------------------